(function(){var global=window;if(global.module==undefined)global.module=function(n,v){var u=global[n];if(u==undefined)global[n]=u={};v(u)};
module("Charts",function(n){var v;v=function(){function f(a){var b,c,d,e;c={};e=f.DEFAULTS;for(b in e){d=e[b];c[b]=d}for(b in a){d=a[b];if(a.hasOwnProperty(b))c[b]=d}return c}f.DEFAULTS={dot_size:5,dot_color:"#00aadd",dot_stroke_color:"#fff",dot_stroke_size:2,line_width:3,line_color:"#00aadd",smoothing:0.4,fill_area:true,area_color:"#00aadd",area_opacity:0.2,show_x_labels:true,show_y_labels:true,label_max:true,label_min:true,max_x_labels:10,max_y_labels:3,font_family:"Helvetica, Arial, sans-serif",
x_label_size:14,y_label_size:14,label_format:"%m/%d",show_grid:false,x_padding:45,y_padding:40,render:"line",bar_width:20};f.merge=function(a,b){var c,d,e;if(a==null)a={};if(b==null)b={};d={};for(c in a){e=a[c];d[c]=e}for(c in b){e=b[c];if(b.hasOwnProperty(c))d[c]=e}return d};return f}();(function(){function f(a,b,c,d,e){this.r=a;this.width=b;this.height=c;this.points=d;this.options=e}f.prototype.draw=function(){var a,b,c,d,e,g,h,i,j;a=Math.round(this.points.length/this.options.step_size);b=this.height-
this.options.y_padding;e=this.width-this.options.x_padding;i=Math.round(b/a);h=this.options.y_padding;d=this.r.set();g=this.points;c=0;for(j=g.length;c<j;c++)if(c%this.options.step_size===0){g=this.points[c].x;d.push(this.r.path("M "+g+", "+this.options.y_padding+" L "+g+", "+b+" Z"))}for(c=0;0<=a?c<=a:c>=a;0<=a?c++:c--){h<=b&&d.push(this.r.path("M "+this.options.x_padding+", "+h+" L "+e+", "+h+" Z"));h+=i}return d.attr({stroke:"#ccc","stroke-width":1}).toBack()};return f})();var u;u=function(){function f(a,
b,c,d){this.r=a;this.point=b;this.opts=c;this.scale_factor=d!=null?d:1.5;this.element=this.r.circle(b.x,b.y,this.opts.dot_size);this.style_dot();this.attach_handlers()}f.prototype.style_dot=function(){this.element.attr({fill:this.opts.dot_color,stroke:this.opts.dot_stroke_color,"stroke-width":this.opts.dot_stroke_size});return this.element.toFront()};f.prototype.activate=function(){this.element.attr({fill:"#333"});return this.element.animate({r:this.opts.dot_size*this.scale_factor},200)};f.prototype.deactivate=
function(){this.element.attr({fill:this.opts.dot_color});return this.element.animate({r:this.opts.dot_size},200)};f.prototype.attach_handlers=function(){var a=this;this.element.mouseover(function(){return a.activate()});return this.element.mouseout(function(){return a.deactivate()})};return f}();var G;G=function(){function f(a){var b,c,d,e;c={};e=f.DEFAULTS;for(b in e){d=e[b];c[b]=d}for(b in a){d=a[b];if(a.hasOwnProperty(b))c[b]=d}return c}f.DEFAULTS={line_width:4,line_color:"#000",area_color:"#00aadd",
area_width:20,area_opacity:0.2,bar_margin:8,show_average:true,average_width:4,average_height:8,average_color:"#000",font_family:"Helvetica, Arial, sans-serif",x_label_size:14,y_label_size:14,x_padding:45,y_padding:40};f.merge=function(a,b){var c,d,e;if(a==null)a={};if(b==null)b={};d={};for(c in a){e=a[c];d[c]=e}for(c in b){e=b[c];if(b.hasOwnProperty(c))d[c]=e}return d};return f}();var s,w;w=function(){function f(a,b){this.r=a;this.format=b!=null?b:"";this.num=0;this.font_family="Helvetica, Arial, sans-serif";
this.color="#333"}f.prototype.x=function(a){this.x_func=a;return this};f.prototype.y=function(a){this.y_func=a;return this};f.prototype.size=function(a){this.size=a;return this};f.prototype.attr=function(a){this.options=a;return this};f.prototype.draw=function(a){a=new s(this.r,this.x_func(this.num),this.y_func(this.num),a,this.format,this.size,this.font_family,this.color,this.options);this.num+=1;return a.draw()};return f}();s=function(){function f(a,b,c,d,e,g,h,i,j){this.r=a;this.x=b;this.y=c;this.text=
d;this.format=e!=null?e:"";this.size=g!=null?g:14;this.font_family=h!=null?h:"Helvetica, Arial, sans-serif";this.color=i!=null?i:"#333";this.options=j!=null?j:void 0}f.prototype.is_date=function(a){return Object.prototype.toString.call(a)==="[object Date]"};f.prototype.parse_date=function(){var a,b,c,d,e;b=this.format.match(/%([a-zA-Z])/g);a=this.format;d=0;for(e=b.length;d<e;d++){c=b[d];a=a.replace(c,this.parse_format(c))}return a};f.prototype.meridian_indicator=function(a){return a.getHours()>=
12?"pm":"am"};f.prototype.to_12_hour_clock=function(a){a=a.getHours()%12;return a===0?12:a};f.prototype.format_number=function(a){if(a>1E6){a=a/1E6;a=Math.round(a*100)/100;return a+"m"}else if(a>1E3){a=a/1E3;return Math.round(a*10)/10+"k"}else return Math.round(a*10)/10};f.prototype.fmt_minutes=function(a){a=a.getMinutes();return a<10?"0"+a:a};f.prototype.parse_format=function(a){switch(a){case "%m":return this.text.getMonth()+1;case "%d":return this.text.getDate();case "%Y":return this.text.getFullYear();
case "%H":return this.text.getHours();case "%M":return this.fmt_minutes(this.text);case "%I":return this.to_12_hour_clock(this.text);case "%p":return this.meridian_indicator(this.text)}};f.prototype.draw=function(){var a;this.element=this.r.text(this.x,this.y,this.is_date(this.text)?this.parse_date(this.text):typeof this.text==="number"?this.format_number(this.text):this.text);a=this.element.getBBox().width;this.element.attr({fill:this.color,"font-size":this.size,"font-weight":"normal","text-anchor":"middle",
"font-family":this.font_family});if(this.options!=null)this.element.attr(this.options);else{a=this.x<a?a/2+5:this.x;this.element.attr({x:a})}return this.element};return f}();var o;o=function(){function f(a,b){var c,d,e;d={};for(c in b){e=b[c];d[c]=e}for(c in a){e=a[c];if(a.hasOwnProperty(c))d[c]=e}return d}f.merge=function(a,b){var c,d,e;if(a==null)a={};if(b==null)b={};d={};for(c in a){e=a[c];d[c]=e}for(c in b){e=b[c];if(b.hasOwnProperty(c))d[c]=e}return d};return f}();var H,p=Object.prototype.hasOwnProperty,
q=function(f,a){function b(){this.constructor=f}for(var c in a)if(p.call(a,c))f[c]=a[c];b.prototype=a.prototype;f.prototype=new b;f.__super__=a.prototype;return f};H=function(f){function a(b){return a.__super__.constructor.call(this,b,a.DEFAULTS)}q(a,f);a.DEFAULTS={bar_margin:30,bar_bg_color:"#bdced3",bar1_color:"90-#2f5e78-#4284a8",bar2_color:"90-#173e53-#225d7c",x_padding:160,y_padding:50,rounding:3,dash_width:3,label_size:14,font_family:"Helvetica, Arial, sans-serif"};return a}(o);var B;B=function(){function f(a){var b,
c,d,e;c={};e=f.DEFAULTS;for(b in e){d=e[b];c[b]=d}for(b in a){d=a[b];if(a.hasOwnProperty(b))c[b]=d}return c}f.DEFAULTS={bar_width:20,bar_spacing:20,bar_color:"#00aadd",rounding:0,font_family:"Helvetica, Arial, sans-serif",show_x_labels:true,show_y_labels:true,x_label_size:14,x_label_color:"#333",y_label_size:14,y_label_color:"#333",show_grid:false,x_padding:25,y_padding:40};f.merge=function(a,b){var c,d,e;if(a==null)a={};if(b==null)b={};d={};for(c in a){e=a[c];d[c]=e}for(c in b){e=b[c];if(b.hasOwnProperty(c))d[c]=
e}return d};return f}();var C,r,O=function(f,a){return function(){return f.apply(a,arguments)}};C=function(){function f(){this.scale=O(this.scale,this)}f.prototype.domain=function(a){this.domain_min=Math.min.apply(Math.min,a);this.domain_max=Math.max.apply(Math.max,a);return this};f.prototype.range=function(a){this.range_min=Math.min.apply(Math.min,a);this.range_max=Math.max.apply(Math.max,a);return this.scale};f.prototype.scale=function(a){var b;b=this.domain_max-this.domain_min;return(this.domain_max*
this.range_min-this.domain_min*this.range_max)/b+a*((this.range_max-this.range_min)/b)};return f}();r=function(){function f(){}f.get_ranges_for_points=function(a){var b,c,d,e,g;c=[];d=[];e=0;for(g=a.length;e<g;e++){b=a[e];c.push(b.x);d.push(b.y)}a=Math.max.apply(Math.max,c);b=Math.max.apply(Math.max,d);c=Math.min.apply(Math.min,c);d=Math.min.apply(Math.min,d);return[a,c,b,d]};f.calc_scaling_factors=function(a,b,c,d){var e;e=a-b;return[(a*d-c*b)/e,(c-d)/e]};f.scale_points=function(a,b,c,d,e){var g,
h,i,j,l,m;j=f.get_ranges_for_points(c);g=j[0];i=j[1];h=j[2];j=j[3];if(j===h)h+=1;if(i===g)g+=1;d=f.calc_scaling_factors(g,i,a-d,d);a=d[0];d=d[1];h=f.calc_scaling_factors(h,j,b-e,e);e=h[0];g=h[1];h=[];i=0;for(m=c.length;i<m;i++){l=c[i];j=a+l.x*d;l=b-(e+l.y*g);h.push(new k(j,l))}return h};f.threshold=function(a,b){return a>b?b:a};return f}();n.Scaling=r;n.Scaler=C;var k;k=function(){function f(a,b){this.y=b;if(this.is_date(a)){this.x=a.getTime();this.is_date_type=true}else this.x=a}f.prototype.is_date=
function(a){return Object.prototype.toString.call(a)==="[object Date]"};return f}();n.Point=k;var D;Raphael.fn.triangle=function(f,a,b){b*=1.75;return this.path("M".concat(f,",",a,"m0-",b*0.58,"l",b*0.5,",",b*0.87,"-",b,",0z"))};D=function(){function f(a){this.r=a}f.prototype.black_nub=function(a,b,c,d,e){var g,h,i,j,l,m;if(b==null)b=10;if(c==null)c=8;if(e==null)e=0;g=a.getBBox();d=g.x;m=g.y;a=g.width;g=g.height;h=d+a/2;l=a+2*b;i=g+2*c;j=this.r.set();j.push(this.r.rect(h-l/2,m-c,l,i,e));j.push(this.r.triangle(d+
a+b+2,m+2+0.5*g,4).rotate(90));return j.attr({fill:"#333",stroke:"transparent","stroke-width":0}).toBack()};f.prototype.straight_line=function(a,b){return this.r.path("M"+a.x+","+a.y+"L"+b.x+","+b.y)};f.prototype.vertical_dashed_line=function(a,b,c,d){var e,g,h;if(c==null)c=3;if(d==null)d=10;g=Math.floor((b.y-a.y)/d);b=this.r.set();e=0;for(h=g-1;0<=h?e<=h:e>=h;0<=h?e++:e--)if(e%2===0){g=this.r.rect(a.x-0.5*c,e*d+a.y,c,d);b.push(g)}return b};f.prototype.get_points_along_top_of_bbox=function(a,b){var c,
d,e;if(b==null)b=0;c=a.getBBox();d=c.x;e=c.x+c.width;c=c.y+b;return[new k(d,c),new k(e,c)]};f.prototype.one_px_highlight=function(a){a=this.get_points_along_top_of_bbox(a,2);this.straight_line(a[0],a[1]).attr({"stroke-width":1,stroke:"rgba(255,255,255,0.3)"});return this.straight_line};f.prototype.one_px_shadow=function(a){a=this.get_points_along_top_of_bbox(a);this.straight_line(a[0],a[1]).attr({"stroke-width":0.5,stroke:"rgba(0,0,0,0.5)"});return this.straight_line};return f}();n.Effects=D;var y;
y=function(){function f(a,b,c,d){var e,g,h=this;this.r=a;if(d==null)d=true;if(typeof c==="number")c=Math.round(c*100)/100;e=b.getBBox();g=e.x;a=e.y;e=g+e.width/2;this.popup=this.r.set();this.popup.push(this.r.rect(e-25,a-35,50,25,5));this.popup.push(this.r.triangle(e,a-10+4,4).rotate(180));this.popup.attr({fill:"rgba(0,0,0,.4)","fill-opacity":0,stroke:"transparent","stroke-width":0});this.text=this.r.text(e,a-22.5,c);this.text.attr({fill:"#fff","font-size":14,"text-anchor":"middle",width:50,height:25,
"fill-opacity":0,"font-weight":"bold"});this.popup.toFront();this.text.toFront();if(d===true){b.mouseover(function(){return h.show()});b.mouseout(function(){return h.hide()})}}f.prototype.animate_opacity=function(a,b,c){var d=this;if(c==null)c=200;return a.animate({"fill-opacity":b},c,function(){if(b===0){d.text.toBack();return d.popup.toBack()}})};f.prototype.hide=function(){this.animate_opacity(this.popup,0);return this.animate_opacity(this.text,0)};f.prototype.show=function(){this.popup.toFront();
this.text.toFront();this.animate_opacity(this.popup,0.8);return this.animate_opacity(this.text,1)};return f}();n.Tooltip=y;var I;I=function(){function f(a,b,c,d,e,g){this.r=a;this.raw_points=b;this.scaled_points=c;this.height=d;this.width=e;this.options=g!=null?g:{};this.effective_height=this.height-this.options.y_padding;this.x_offset=this.options.bar_width/2}f.prototype.draw=function(){return this.draw_bars()};f.prototype.draw_bars=function(){var a,b,c,d,e,g,h,i,j;e=this.r.set();g=[];c=b=0;j=this.scaled_points;
a=0;for(i=j.length;a<i;a++){d=j[a];h=d.x-this.x_offset;d=this.r.rect(h,d.y,this.options.bar_width,this.effective_height-d.y);e.push(d);g.push(new y(this.r,d,this.raw_points[a].y));if(this.raw_points[a].y>=this.raw_points[b].y)b=a;if(this.raw_points[a].y<this.raw_points[c].y)c=a}e.attr({fill:this.options.line_color,stroke:"none"});this.options.label_max&&g[b].show();if(this.options.label_min)return g[c].show()};return f}();var E;E=function(){function f(){}f.create_path=function(a,b){var c,d,e,g,h;
if(b==null)b=0.5;g="M"+a[0].x+", "+a[0].y;e=0;for(h=a.length;e<h;e++)if(e!==0){d=f.get_control_points(a,e-1,b);c=d[0];d=d[1];g+="C"+c.x+","+c.y+" "+d.x+","+d.y+" "+a[e].x+","+a[e].y}return g};f.get_control_points=function(a,b,c,d){var e,g,h,i;if(d==null)d=3;g=this.get_prev_and_next_points(a,b);e=g[0];g=g[1];b=this.get_prev_and_next_points(a,b+1);a=b[0];h=b[1];b=this.get_tangent(e,g);e=b[0];b=b[1];i=this.get_tangent(a,h);h=i[0];i=i[1];e=a.x+e*c/d;a=a.y+b*c/d;b=g.x-h*c/d;c=g.y-i*c/d;d=new k(e,a);c=
new k(b,c);return[d,c]};f.get_prev_and_next_points=function(a,b){var c,d;d=b-1;c=b+1;if(d<0)d=0;if(c>=a.length)c=a.length-1;return[a[d],a[c]]};f.get_tangent=function(a,b){return[b.x-a.x,b.y-a.y]};return f}();n.Bezier=E;var J;J=function(){function f(a,b,c,d,e,g){this.r=a;this.raw_points=b;this.scaled_points=c;this.height=d;this.width=e;this.options=g!=null?g:{}}f.prototype.draw=function(){var a;a=E.create_path(this.scaled_points,this.options.smoothing);this.options.fill_area&&this.draw_area(a);this.draw_curve(a);
this.options.dot_size>0&&this.draw_dots_and_tooltips(this.scaled_points,this.raw_points)};f.prototype.draw_curve=function(a){return this.r.path(a).attr({stroke:this.options.line_color,"stroke-width":this.options.line_width}).toFront()};f.prototype.draw_area=function(a){var b,c,d;c=this.scaled_points;d=this.height-this.options.y_padding;b=c[c.length-1];c=c[0];a+="L "+b.x+", "+d+" ";a+="L "+c.x+", "+d+" ";a+="Z";a=this.r.path(a);a.attr({fill:this.options.area_color,"fill-opacity":this.options.area_opacity,
"stroke-width":0});return a.toBack()};f.prototype.draw_dots_and_tooltips=function(){var a,b,c,d,e,g,h,i,j;h=this.scaled_points;g=this.raw_points;i=[];a=[];b=d=c=0;for(j=h.length;b<j;b++){e=h[b];a.push(new u(this.r,e,this.options));i.push(new y(this.r,a[b].element,g[b].y));if(g[b].y>=g[c].y)c=b;if(g[b].y<g[d].y)d=b}if(this.options.label_max){i[c].show();a[c].activate()}if(this.options.label_min){i[d].show();return a[d].activate()}};return f}();var K;K=function(f){return f.hasOwnProperty("tagName")?
true:false};o=function(){function f(a,b){var c,d;c=K(a)?a:document.getElementById(a);d=this.get_dimensions(c);this.width=d[0];this.height=d[1];this.r=Raphael(c,this.width,this.height);this.options=b}f.prototype.get_dimensions=function(a){var b;b=parseInt(a.style.width);a=parseInt(a.style.height);return[b,a]};f.prototype.clear=function(){return this.r.clear()};return f}();var z;p=Object.prototype.hasOwnProperty;q=function(f,a){function b(){this.constructor=f}for(var c in a)if(p.call(a,c))f[c]=a[c];
b.prototype=a.prototype;f.prototype=new b;f.__super__=a.prototype;return f};z=function(f){function a(b,c){if(c==null)c={};a.__super__.constructor.call(this,b,new v(c));this.padding=26;this.all_points=[];this.line_indices=[];this.line_options=[]}q(a,f);a.prototype.add_line=function(b){var c,d,e,g;d=b.data;if(!(d.length<1)){e=function(){var h,i,j;j=[];h=0;for(i=d.length;h<i;h++){c=d[h];j.push(new k(c[0],c[1]))}return j}();g=this.all_points.length;this.line_indices.push([g,g+e.length-1]);this.all_points.push.apply(this.all_points,
e);this.line_options.push(v.merge(this.options,b.options))}};a.prototype.draw_grid=function(b,c){var d,e,g,h,i,j;if(b==null)b=[];if(c==null)c=[];d=this.height-this.options.y_padding;h=this.width-this.options.x_padding;e=this.r.set();i=0;for(j=b.length;i<j;i++){g=b[i];e.push(this.r.path("M "+g+", "+this.options.y_padding+" L "+g+", "+d+" Z"))}d=0;for(i=c.length;d<i;d++){g=c[d];e.push(this.r.path("M "+this.options.x_padding+", "+g+" L "+h+", "+g+" Z"))}return e.attr({stroke:"#ccc","stroke-width":1}).toBack()};
a.prototype._draw_y_labels=function(b){var c,d,e,g,h,i,j,l,m;c=this.options.label_format;l=this.options.y_label_size;d=this.options.font_family;i=l+5;j=r.scale_points(this.width,this.height,b,this.options.x_padding,this.options.y_padding);h=[];e=0;for(m=j.length;e<m;e++){g=j[e];(new s(this.r,i,g.y,b[e].y,c,l,d)).draw();h.push(g.y)}return h};a.prototype.calc_y_label_step_size=function(b,c,d){if(d==null)d=this.options.max_y_labels;b=(c-b)/(d-1);if(c>1){b=Math.round(b);if(b===0)b=1}return b};a.prototype.draw_y_labels=
function(){var b,c,d,e;e=r.get_ranges_for_points(this.all_points);c=e[2];b=e[3];if(c===b)return this._draw_y_labels([new k(0,c)]);e=b;d=this.calc_y_label_step_size(b,c);for(b=[];e<=c;){b.push(new k(0,e));e+=d}if(c>1)b[b.length-1].y=Math.round(c);return this._draw_y_labels(b)};a.prototype.draw_x_label=function(b,c){var d,e,g;d=this.options.label_format;g=this.options.x_label_size;e=this.options.font_family;return(new s(this.r,c.x,this.height-g,b.is_date_type===true?new Date(b.x):Math.round(b.x),d,
g,e)).draw()};a.prototype.draw_x_labels=function(b,c){var d,e,g,h,i,j;e=[];h=this.options.max_x_labels;this.draw_x_label(b[0],c[0]);e.push(c[0].x);if(!(h<2)){g=c.length-1;this.draw_x_label(b[g],c[g]);e.push(c[g].x);if(!(h<3)){g=c.length-2;h=g/(h-1);d=Math.round(h);if(h!==d)h=d+1;for(d=h;d<g;){j=b[d];i=c[d];this.draw_x_label(j,i);e.push(i.x);d+=h}return e}}};a.prototype.draw_line=function(b,c,d){return this.options.render==="bar"?(new I(this.r,b,c,this.height,this.width,d)).draw():(new J(this.r,b,
c,this.height,this.width,d)).draw()};a.prototype.clear=function(){a.__super__.clear.call(this);this.all_points=[];this.line_indices=[];return this.line_options=[]};a.prototype.draw=function(){var b,c,d,e,g,h;if(!(this.all_points.length<1)){this.r.clear();this.scaled_points=r.scale_points(this.width,this.height,this.all_points,this.options.x_padding,this.options.y_padding);h=this.line_indices;d=0;for(g=h.length;d<g;d++){e=h[d];b=e[0];c=e[1];e=this.scaled_points.slice(b,c+1||9E9);c=this.all_points.slice(b,
c+1||9E9);b=this.line_options[d];this.draw_line(c,e,b);if(d===0){if(this.options.show_x_labels===true)this.x_label_coordinates=this.draw_x_labels(c,e);if(this.options.show_y_labels===true)this.y_label_coordinates=this.draw_y_labels();this.options.show_grid===true&&this.draw_grid(this.x_label_coordinates,this.y_label_coordinates)}}}};return a}(o);n.LineChart=z;var L,M,N;p=Object.prototype.hasOwnProperty;q=function(f,a){function b(){this.constructor=f}for(var c in a)if(p.call(a,c))f[c]=a[c];b.prototype=
a.prototype;f.prototype=new b;f.__super__=a.prototype;return f};M=function(f,a,b){return{label:f,raw_value:a,index_value:b}};N=function(f,a,b){return{label:f,index_value:a,opacity:b}};L=function(f){function a(b,c){if(c==null)c={};a.__super__.constructor.call(this,b,new H(c));this.effects=new D(this.r);this.bars=[];this.guides=[];this.index=100}q(a,f);a.prototype.add=function(b,c,d){return this.bars.push(M(b,c,d))};a.prototype.add_guide_line=function(b,c,d){if(d==null)d=1;return this.guides.push(N(b,
c,d))};a.prototype.add_raw_label=function(b){var c,d=this;c=(new w(this.r)).x(function(){return d.width-10}).y(function(e){return e*15+15}).size(this.options.label_size).attr({fill:"#333","text-anchor":"end","font-weight":"bold"});c.draw(b);return c.draw("(raw value)").attr({"font-weight":"normal","font-size":10})};a.prototype.set_bar_height=function(){return this.bar_height=(this.height-this.options.y_padding)/this.bars.length-this.options.bar_margin};a.prototype.set_threshold=function(){var b,c;
c=function(){var d,e,g,h;g=this.guides;h=[];d=0;for(e=g.length;d<e;d++){b=g[d];h.push(b.index_value)}return h}.call(this);return this.threshold=Math.max.apply(Math.max,c)};a.prototype.draw_raw_bar=function(b,c){var d,e;d=Math.floor(7);e=this.options.x_padding-10;this.r.rect(this.width-e,c-d,this.width-this.options.x_padding,this.bar_height+14,this.options.rounding).attr({fill:"rgba(0,0,0,.1)","stroke-width":0});return this.effects.straight_line(new k(this.width-e,this.options.y_padding-10),new k(this.width-
e,this.height)).attr({stroke:"rgba(0,0,0,0.25)","stroke-width":0.1})};a.prototype.draw_bg_bar=function(b,c,d){c(b);b=Math.floor(7);return this.r.rect(this.options.x_padding-b,d-b,this.width,this.bar_height+14,this.options.rounding).attr({fill:this.options.bar_bg_color,"stroke-width":0}).toBack()};a.prototype.shade_bar=function(b,c){if(c==null)c=this.options.bar1_color;b.attr({fill:c,"stroke-width":0});this.effects.one_px_shadow(b);return this.effects.one_px_highlight(b)};a.prototype.render_bar=function(b,
c,d,e){if(e==null)e=this.options.bar1_color;return this.shade_bar(this.r.rect(b,c,d,this.bar_height,this.options.rounding),e)};a.prototype.draw_bar=function(b,c,d){var e;e=c(r.threshold(b,this.threshold));if(b>this.index){b=c(this.index);this.render_bar(this.options.x_padding,d,b-this.options.x_padding);return this.render_bar(b,d,e-b,this.options.bar2_color)}else return this.render_bar(this.options.x_padding,d,e-this.options.x_padding)};a.prototype.draw_guide_line=function(b,c,d,e){var g,h;if(e==
null)e=1;h=new k(d,this.options.y_padding);g=new k(d,this.height);this.effects.vertical_dashed_line(h,g,this.options.dash_width).attr({fill:"rgba(0,0,0,"+e+")","stroke-width":0});e=(new w(this.r)).x(function(){return d}).y(function(i){return i*15+15}).size(this.options.label_size).attr({fill:"rgba(0,0,0,"+e+")"});e.draw(b).attr({"font-weight":"bold"});return e.draw(c).attr({"font-size":10})};a.prototype.sort_bars_by_index=function(){var b,c;c=function(){var d,e,g,h;g=this.bars;h=[];d=0;for(e=g.length;d<
e;d++){b=g[d];h.push(b)}return h}.call(this);c.sort(function(d,e){return e.index_value-d.index_value});return c};a.prototype.clear=function(){a.__super__.clear.call(this);this.bars=[];return this.guides=[]};a.prototype.draw=function(){var b,c,d,e,g,h,i,j,l,m,t,A=this;this.set_bar_height();this.set_threshold();h=this.bar_height+this.options.bar_margin;d=this.bar_height/2;l=this.options.y_padding;e=(new w(this.r)).y(function(x){return x*h+l+d}).x(function(){return 5}).size(12).attr({fill:"#fff","text-anchor":"start"});
g=(new w(this.r)).y(function(x){return x*h+l+d}).x(function(){return A.width-10}).size(this.options.label_size).attr({fill:"#333","text-anchor":"end"});i=(new C).domain([0,this.threshold]).range([this.options.x_padding,this.width-this.options.x_padding]);j=function(x){return x*(A.bar_height+A.options.bar_margin)+A.options.y_padding};t=this.sort_bars_by_index();c=0;for(m=t.length;c<m;c++){b=t[c];this.draw_bg_bar(b.index_value,i,j(c));this.draw_raw_bar(b.raw_value,j(c));this.draw_bar(b.index_value,
i,j(c));g.draw(b.raw_value);b=e.draw(b.label);this.effects.black_nub(b)}j=this.guides;m=[];e=0;for(g=j.length;e<g;e++){c=j[e];m.push(this.draw_guide_line(c.label,c.index_value,i(c.index_value),c.opacity))}return m};return a}(o);n.IndexChart=function(f,a){return new L(f,a)};var F;p=Object.prototype.hasOwnProperty;q=function(f,a){function b(){this.constructor=f}for(var c in a)if(p.call(a,c))f[c]=a[c];b.prototype=a.prototype;f.prototype=new b;f.__super__=a.prototype;return f};F=function(f,a,b,c){return{label:f,
value:a,average:b,comparison:c}};z=function(f){function a(b,c){if(c==null)c={};a.__super__.constructor.call(this,b,new G(c));this.bars=[]}q(a,f);a.prototype.add=function(){return this.bars.push(F.apply(F,arguments))};a.prototype.draw_background=function(b,c){return this.r.rect(this.options.x_padding,c,b.x,this.options.area_width).attr({fill:this.options.area_color,"stroke-width":0})};a.prototype.draw_line=function(b,c){return this.r.rect(this.options.x_padding,c.y-this.options.line_width/2,b.x,this.options.line_width).attr({fill:this.options.line_color,
"stroke-width":0})};a.prototype.draw_average=function(b,c){return this.r.rect(b.x-this.options.average_width/2,c-this.options.average_height/2,this.options.average_width,this.options.average_height).attr({fill:this.options.average_color,"stroke-width":0})};a.prototype.draw_label=function(){};a.prototype.draw=function(){var b,c,d,e,g,h,i,j;i=this.bars;j=[];c=0;for(h=i.length;c<h;c++){b=i[c];e=r.scale_points(this.width,this.height,[new k(b.comparison,0),new k(b.value,0),new k(b.average,0),new k(0,0)],
this.options.x_padding,this.options.y_padding);g=c*(this.options.area_width+this.options.bar_margin);this.draw_background(e[0],g);d=g+this.options.area_width/2;this.draw_line(e[1],new k(e[0].x,d));this.draw_average(e[2],d);j.push((new s(this.r,0,g+this.options.area_width/2,b.label,"",this.size=14,this.options.font_family)).draw())}return j};return a}(o);n.BulletChart=z;p=Object.prototype.hasOwnProperty;q=function(f,a){function b(){this.constructor=f}for(var c in a)if(p.call(a,c))f[c]=a[c];b.prototype=
a.prototype;f.prototype=new b;f.__super__=a.prototype;return f};o=function(f){function a(b,c){if(c==null)c={};a.__super__.constructor.call(this,b,new B(c));this.effective_height=this.height-this.options.y_padding;this.bar_options=[];this.bars=[];this.values=[]}q(a,f);a.prototype.add=function(b){var c,d;c=b.label;d=b.value;this.bar_options.push(B.merge(this.options,b.options));this.values.push(d);return this.bars.push({label:c,value:d})};a.prototype.render_bar=function(b,c,d,e){this.r.rect(d.x,d.y,
this.options.bar_width,this.effective_height-d.y,this.options.rounding).attr({fill:e.bar_color,"stroke-width":0});(new s(this.r,d.x+this.options.bar_width/2,this.height-(this.options.x_label_size+5),b,"",this.options.x_label_size,this.options.font_family,this.options.x_label_color)).draw();return(new s(this.r,d.x+this.options.bar_width/2,d.y-this.options.y_label_size-5,c,"",this.options.y_label_size,this.options.font_family,this.options.y_label_color)).draw()};a.prototype.draw=function(){var b,c,
d,e,g,h,i,j;b=function(){var l,m,t;m=this.values;t=[];c=0;for(l=m.length;c<l;c++){g=m[c];t.push(new k(c,g))}return t}.call(this);b.push(new k(0,0));this.scaled_values=r.scale_points(this.width,this.height,b,this.options.x_padding,this.options.y_padding);i=this.bars;j=[];c=0;for(h=i.length;c<h;c++){b=i[c];d=c*(this.options.bar_width+this.options.bar_spacing)+this.options.x_padding;e=this.scaled_values[c].y;d=new k(d,e);j.push(this.render_bar(b.label,b.value,d,this.bar_options[c]))}return j};return a}(o);
n.BarChart=o});})();
